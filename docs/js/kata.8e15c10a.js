(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["kata"],{"19ee":function(t,e,a){"use strict";a("5ff9")},"5ff9":function(t,e,a){},ccb2:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"page-content page-kata pro-module"},[e("div",{staticClass:"pro-module-hd clearfix"},[e("h2",[t._v("发文："+t._s(t.dialogTitle))])]),e("div",{staticClass:"pro-module-bd"},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:6,maxRows:10},disabled:t.isTextDisabled,placeholder:"请输入内容",autofocus:""},model:{value:t.articleText,callback:function(e){t.articleText=e},expression:"articleText"}}),e("el-form",{staticClass:"form-content",attrs:{inline:!0,model:t.formContent}},[e("el-form-item",{attrs:{label:"练习文本"}},[e("el-cascader",{attrs:{size:"small","show-all-levels":!1,"expand-trigger":"hover",options:t.contentOptions,placeholder:"请选择练习文本"},model:{value:t.formContent.contentName,callback:function(e){t.$set(t.formContent,"contentName",e)},expression:"formContent.contentName"}})],1),e("el-form-item",{attrs:{label:"总字数"}},[e("el-input",{staticClass:"form-field-mini",attrs:{size:"small",disabled:""},model:{value:t.formContent.contentLength,callback:function(e){t.$set(t.formContent,"contentLength",e)},expression:"formContent.contentLength"}})],1),e("el-form-item",{attrs:{label:"每段字数"}},[1===t.currentTextType?e("el-input-number",{staticClass:"form-field",attrs:{size:"small",min:1,step:t.paragraphSizeStep},model:{value:t.formContent.paragraphSize,callback:function(e){t.$set(t.formContent,"paragraphSize",e)},expression:"formContent.paragraphSize"}}):e("el-input",{staticClass:"form-field-mini",attrs:{value:"动态",size:"small",disabled:""}})],1),e("el-form-item",{attrs:{label:"开始段数"}},[e("el-input-number",{staticClass:"form-field",attrs:{size:"small",min:1,max:t.formContent.paragraphCount},model:{value:t.formContent.currentParagraphNo,callback:function(e){t.$set(t.formContent,"currentParagraphNo",e)},expression:"formContent.currentParagraphNo"}})],1),e("el-form-item",{attrs:{label:"总段数"}},[e("el-input",{staticClass:"form-field-mini",attrs:{size:"small",disabled:""},model:{value:t.formContent.paragraphCount,callback:function(e){t.$set(t.formContent,"paragraphCount",e)},expression:"formContent.paragraphCount"}})],1)],1),e("el-divider"),e("el-form",{staticClass:"form-content",attrs:{inline:!0}},[e("el-form-item",{attrs:{label:"开启指标"}},[e("el-switch",{attrs:{value:t.criteriaOpen},on:{change:t.handleCriteriaOpenChange}})],1),e("el-form-item",{attrs:{label:"击键≥"}},[e("el-input-number",{staticClass:"form-field",attrs:{size:"small",value:t.criteriaHitSpeed,min:0,max:30,step:.5,disabled:t.isHitSpeedCriteriaDisabled},on:{change:t.handleHitSpeedChange}}),t.isMobile?e("el-tag",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning",size:"mini"}},[t._v("移动端无效")]):t._e()],1),e("el-form-item",{attrs:{label:"速度≥"}},[e("el-input-number",{staticClass:"form-field",attrs:{size:"small",value:t.criteriaSpeed,min:0,max:500,step:20,disabled:t.isCriteriaDisabled},on:{change:t.handleSpeedChange}})],1),e("el-form-item",{attrs:{label:"键准≥"}},[e("el-input-number",{staticClass:"form-field",attrs:{size:"small",value:t.criteriaAccuracy,min:0,max:100,step:1,disabled:t.isCriteriaDisabled},on:{change:t.handleAccuracyChange}})],1),e("el-form-item",{attrs:{label:"未达标时『或』有错字时"}},[e("el-select",{staticClass:"form-field",attrs:{size:"small",placeholder:"请选择类型",disabled:t.isCriteriaDisabled,value:t.criteriaAction},on:{change:t.handleActionChange}},[e("el-option",{attrs:{label:"乱序",value:"random"}}),e("el-option",{attrs:{label:"重打",value:"retry"}}),e("el-option",{attrs:{label:"不处理",value:"noop"}})],1)],1)],1),e("el-divider"),e("div",{staticClass:"right"},[e("el-button",{on:{click:t.handleCancel}},[t._v("取 消")]),e("el-button",{attrs:{disabled:!t.hasArticleText},on:{click:t.handleShuffle}},[t._v("全局乱序")]),e("el-button",{attrs:{disabled:!t.hasArticleText},on:{click:t.startFullKata}},[t._v("发送全文")]),e("el-button",{attrs:{type:"primary",disabled:!t.hasArticleText},on:{click:t.startKata}},[t._v("发文")])],1)],1)])},r=[],o=(a("14d9"),a("9ab4")),n=a("1b40"),l=a("4bb5"),s=a("fed7"),c=a("f471"),p=a("beda");const d=Object(l["e"])("article"),h=Object(l["e"])("kata");let u=class extends n["c"]{constructor(){super(...arguments),this.articleText="",this.dialogTitle="自由发文",this.formContent={contentName:[],contentLength:0,currentParagraphNo:1,paragraphSize:Object(s["f"])()?5:10,paragraphCount:1},this.contentOptions=[{value:"free",label:"自由",id:1,children:[{id:-1,value:"freeText",label:"手动输入"}]},{value:"tiger",label:"虎码",id:2,children:[]},{value:"word",label:"单字",id:3,children:[]}]}get isTextDisabled(){return"freeText"!==this.formContent.contentName[1]}get isCriteriaDisabled(){return!this.criteriaOpen}get isHitSpeedCriteriaDisabled(){return this.isCriteriaDisabled||Object(s["f"])()}get isMobile(){return Object(s["f"])()}get hasArticleText(){return this.articleText.length>0}get currentTextType(){return-1!==this.articleText.indexOf("\n")?2:1}get paragraphSizeStep(){const t=-1!==["tiger","word"].indexOf(this.formContent.contentName[0]);return t?5:100}paragraphSizeChange(t){2!==this.currentTextType&&(this.formContent.paragraphCount=Math.ceil(this.articleText.length/t))}contentChange(t){const e=t[0],a=t[1];if("freeText"===a)return this.articleText="",void(this.dialogTitle="自由发文");const i=this.contentOptions.find(t=>t.value===e),r=null===i||void 0===i?void 0:i.children.find(t=>t.value===a);p["a"].getKataOptionById((null===r||void 0===r?void 0:r.id)||-1).then(t=>{this.articleText=t.content,this.dialogTitle=""+t.title}).catch(()=>{this.$message({message:"内容获取失败，请刷新重试！",type:"error"})})}articleTextChange(t){const{contentName:e}=this.formContent;this.formContent.contentLength=t.length,-1!==["tiger","word"].indexOf(e[0])?this.formContent.paragraphSize=this.formContent.paragraphSize>100?10:this.formContent.paragraphSize:this.formContent.paragraphSize=Math.min(500,t.length),2===this.currentTextType?this.formContent.paragraphCount=t.trim().split("\n").length:this.formContent.paragraphCount=Math.ceil(t.length/this.formContent.paragraphSize)}handleCriteriaOpenChange(t){this.updateCriteria({criteriaOpen:t})}handleHitSpeedChange(t){this.updateCriteria({criteriaHitSpeed:t})}handleSpeedChange(t){this.updateCriteria({criteriaSpeed:t})}handleAccuracyChange(t){this.updateCriteria({criteriaAccuracy:t})}handleActionChange(t){this.updateCriteria({criteriaAction:t})}handleCancel(){this.$router.push("/").catch(c["a"])}handleShuffle(){this.articleText=Object(s["i"])(this.articleText.split("")).join("")}startFullKata(){this.startKata(this.articleText.length)}startKata(t=0){const e={articleTitle:this.dialogTitle,articleText:this.articleText.trim().split("\n").filter(t=>!!t).join(2===this.currentTextType?"\n":""),textType:this.currentTextType,currentParagraphNo:this.formContent.currentParagraphNo,paragraphSize:t>0?t:this.formContent.paragraphSize};this.loadArticle(e),this.loadMatch(this.nextParagraph),this.$router.push("/").catch(c["a"])}created(){this.init(),p["a"].getKataList().then(t=>{this.contentOptions=t})}destroyed(){}};Object(o["a"])([d.Action("loadMatch")],u.prototype,"loadMatch",void 0),Object(o["a"])([h.State("criteriaOpen")],u.prototype,"criteriaOpen",void 0),Object(o["a"])([h.State("criteriaHitSpeed")],u.prototype,"criteriaHitSpeed",void 0),Object(o["a"])([h.State("criteriaSpeed")],u.prototype,"criteriaSpeed",void 0),Object(o["a"])([h.State("criteriaAccuracy")],u.prototype,"criteriaAccuracy",void 0),Object(o["a"])([h.State("criteriaAction")],u.prototype,"criteriaAction",void 0),Object(o["a"])([h.Action("init")],u.prototype,"init",void 0),Object(o["a"])([h.Action("loadArticle")],u.prototype,"loadArticle",void 0),Object(o["a"])([h.Action("updateCriteria")],u.prototype,"updateCriteria",void 0),Object(o["a"])([h.Action("next")],u.prototype,"next",void 0),Object(o["a"])([h.Action("getNextParagraph")],u.prototype,"getNextParagraph",void 0),Object(o["a"])([h.Getter("nextParagraph")],u.prototype,"nextParagraph",void 0),Object(o["a"])([Object(n["d"])("formContent.paragraphSize")],u.prototype,"paragraphSizeChange",null),Object(o["a"])([Object(n["d"])("formContent.contentName")],u.prototype,"contentChange",null),Object(o["a"])([Object(n["d"])("articleText")],u.prototype,"articleTextChange",null),u=Object(o["a"])([Object(n["a"])({components:{}})],u);var m=u,f=m,b=(a("19ee"),a("2877")),g=Object(b["a"])(f,i,r,!1,null,null,null);e["default"]=g.exports},f540:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"page-content page-reading pro-module"},[t._m(0),e("div",{staticClass:"pro-module-bd"},[e("el-form",{staticClass:"form-content",attrs:{inline:!0,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"书籍上传"}},[e("el-upload",{attrs:{drag:"",action:"#",accept:".txt","auto-upload":!1,"show-file-list":!1,"on-change":t.uploadBook}},[e("i",{staticClass:"el-icon-upload"}),e("div",{staticClass:"el-upload__text"},[t._v("将书籍拖到此处，或"),e("em",[t._v("点击上传")])]),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("文本格式文件，UTF8编码即可（最大支持上传5本书）")])])],1),e("el-divider"),e("el-form",{staticClass:"form-content",attrs:{inline:!0}},[e("el-form-item",{attrs:{label:"开启指标"}},[e("el-switch",{attrs:{value:t.criteriaOpen},on:{change:t.handleCriteriaOpenChange}})],1),e("el-form-item",{attrs:{label:"击键≥"}},[e("el-input-number",{staticClass:"form-field",attrs:{size:"small",value:t.criteriaHitSpeed,min:0,max:30,step:.5,disabled:t.isCriteriaDisabled},on:{change:t.handleHitSpeedChange}})],1),e("el-form-item",{attrs:{label:"键准≥"}},[e("el-input-number",{staticClass:"form-field",attrs:{size:"small",value:t.criteriaAccuracy,min:0,max:100,step:1,disabled:t.isCriteriaDisabled},on:{change:t.handleAccuracyChange}})],1),e("el-form-item",{attrs:{label:"未达标『或』有错字时"}},[e("el-select",{staticClass:"form-field",attrs:{size:"small",placeholder:"请选择类型",disabled:t.isCriteriaDisabled,value:t.criteriaAction},on:{change:t.handleActionChange}},[e("el-option",{attrs:{label:"乱序",value:"random"}}),e("el-option",{attrs:{label:"重打",value:"retry"}}),e("el-option",{attrs:{label:"不处理",value:"noop"}})],1)],1)],1),e("el-table",{staticClass:"achievements-table",attrs:{border:"",data:t.books,stripe:"stripe"}},[e("el-table-column",{attrs:{prop:"id",label:"编号","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.id)+" ")]}}])}),e("el-table-column",{attrs:{prop:"title",label:"书名","min-width":"140","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"currentWords",label:"进度/总字数","min-width":"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("numberWithCommas")(e.row.currentWords))+"/"+t._s(t._f("numberWithCommas")(e.row.totalWords))+" ")]}}])}),e("el-table-column",{attrs:{prop:"paragraphs",label:"总段数","min-width":"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("numberWithCommas")(e.row.paragraphs))+" ")]}}])}),e("el-table-column",{attrs:{prop:"paragraphSize",label:"每段字数","min-width":"80"}}),e("el-table-column",{attrs:{label:"操作",width:"190"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",size:"mini"},nativeOn:{click:function(e){return e.preventDefault(),t.showSettingDialog(a.row.id)}}},[t._v(" 设置 ")]),e("el-button",{attrs:{type:"text",size:"mini"},nativeOn:{click:function(e){return e.preventDefault(),t.startReading(a.row.id)}}},[t._v(" 阅读&跟打 ")]),e("el-button",{attrs:{type:"danger",size:"mini"},nativeOn:{click:function(e){return e.preventDefault(),t.deleteBook(a.row.id)}}},[t._v(" 删除 ")])]}}])})],1)],1)],1),e("el-dialog",{staticClass:"load-text",attrs:{visible:t.showLoadDialog,title:"设置"},on:{"update:visible":function(e){t.showLoadDialog=e}}},[e("el-form",{ref:"form",attrs:{"label-width":"100px"}},[e("el-form-item",{attrs:{label:"进度调整"}},[e("el-slider",{attrs:{min:0,max:t.bookConf.totalWords,"show-input":""},on:{change:t.handleProgressChange},model:{value:t.currentProgress,callback:function(e){t.currentProgress=e},expression:"currentProgress"}})],1),e("el-form-item",{attrs:{label:"每段字数"}},[e("el-input-number",{staticClass:"form-field",attrs:{size:"small",value:t.bookConf.paragraphSize,min:5,max:1e4,step:50},on:{change:t.handleParagraphSizeChange}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.showLoadDialog=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.saveSetting}},[t._v("确 定")])],1)],1)],1)},r=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"pro-module-hd clearfix"},[e("h2",[t._v("阅读：上传书籍 即可跟打阅读")])])}],o=(a("14d9"),a("9ab4")),n=a("1b40"),l=a("4bb5"),s=a("f471"),c=a("5c96"),p=a("beda"),d=a("cfc9");const h=Object(l["e"])("article"),u=Object(l["e"])("kata"),m=Object(l["e"])("reading");let f=class extends n["c"]{constructor(){super(...arguments),this.currentProgress=1,this.showLoadDialog=!1}get isCriteriaDisabled(){return!this.criteriaOpen}handleCriteriaOpenChange(t){this.updateCriteria({criteriaOpen:t})}handleHitSpeedChange(t){this.updateCriteria({criteriaHitSpeed:t})}handleAccuracyChange(t){this.updateCriteria({criteriaAccuracy:t})}handleActionChange(t){this.updateCriteria({criteriaAction:t})}uploadBook(t){if(this.books.length>=5)return void this.$message.error("最大只支持上传5本书籍");const e=c["Loading"].service({lock:!0,text:"正在处理书籍，请耐心等待……",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),a=new FileReader;a.onload=()=>{const i=a.result.replace(/\s/gm,""),r=t.raw.name.replace(".txt",""),o=i.length,n=`${r}-${o}`,l=p["a"].sha1Hmac(n);d["a"].bookShelf.get(l).then(t=>{if(t)this.$message.error("该书籍已存在，不可重复导入");else{const t={id:l,title:r,totalWords:o,paragraphSize:500,currentWords:0,paragraphs:Math.ceil(i.length/10)},e=this.books.concat(t);this.loadBooks(e),d["a"].bookShelf.put(e,"books"),d["a"].bookShelf.put({id:l,title:r,content:i},l)}e.close()}).catch(t=>{e.close(),this.$message.error("书籍导入出错，请重试"),console.log("error",t)})},a.readAsText(t.raw)}startReading(t){if(!t)return;this.selectBook(t);const e=this.bookConf;d["a"].bookShelf.get(t).then(t=>{if(t){const a=t,i={articleTitle:a.title,articleText:a.content,currentParagraphNo:Math.ceil((e.currentWords+1)/e.paragraphSize),paragraphSize:e.paragraphSize,isReading:!0};this.loadArticle(i),this.loadMatch(this.nextParagraph),this.$router.push("/").catch(s["a"])}})}deleteBook(t){this.deleteBookById(t)}showSettingDialog(t){this.selectBook(t),this.currentProgress=this.bookConf.currentWords,this.showLoadDialog=!0}saveSetting(t){this.showLoadDialog=!1,this.updateBooksByConf(t),this.saveBooksConfToDB()}handleProgressChange(t){this.updateBookConf({currentWords:t})}handleParagraphSizeChange(t){this.updateBookConf({paragraphSize:t})}created(){this.init(),d["a"].bookShelf.get("books").then(t=>{this.loadBooks(t)})}destroyed(){}};Object(o["a"])([h.Action("loadMatch")],f.prototype,"loadMatch",void 0),Object(o["a"])([u.State("criteriaOpen")],f.prototype,"criteriaOpen",void 0),Object(o["a"])([u.State("criteriaHitSpeed")],f.prototype,"criteriaHitSpeed",void 0),Object(o["a"])([u.State("criteriaAccuracy")],f.prototype,"criteriaAccuracy",void 0),Object(o["a"])([u.State("criteriaAction")],f.prototype,"criteriaAction",void 0),Object(o["a"])([u.Action("init")],f.prototype,"init",void 0),Object(o["a"])([u.Action("loadArticle")],f.prototype,"loadArticle",void 0),Object(o["a"])([u.Action("updateCriteria")],f.prototype,"updateCriteria",void 0),Object(o["a"])([u.Getter("nextParagraph")],f.prototype,"nextParagraph",void 0),Object(o["a"])([m.Action("loadBooks")],f.prototype,"loadBooks",void 0),Object(o["a"])([m.Action("deleteBookById")],f.prototype,"deleteBookById",void 0),Object(o["a"])([m.Action("selectBook")],f.prototype,"selectBook",void 0),Object(o["a"])([m.Action("updateBookConf")],f.prototype,"updateBookConf",void 0),Object(o["a"])([m.Action("updateBooksByConf")],f.prototype,"updateBooksByConf",void 0),Object(o["a"])([m.Mutation("saveBooksConfToDB")],f.prototype,"saveBooksConfToDB",void 0),Object(o["a"])([m.Getter("books")],f.prototype,"books",void 0),Object(o["a"])([m.Getter("bookConf")],f.prototype,"bookConf",void 0),f=Object(o["a"])([n["a"]],f);var b=f,g=b,C=a("2877"),v=Object(C["a"])(g,i,r,!1,null,null,null);e["default"]=v.exports}}]);